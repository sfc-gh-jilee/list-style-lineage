<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lineage List</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <script>
      // Disable browser's automatic scroll restoration on reload
      if ('scrollRestoration' in history) {
        history.scrollRestoration = 'manual';
      }
      
      document.addEventListener('DOMContentLoaded', () => {
        const HEADER_HEIGHT = 28;
        const CONTAINER_PADDING = 16;
        const PANEL_WIDTH = 280;
        const scrollContainer = document.querySelector('.lineage-scroll');
        const headers = Array.from(document.querySelectorAll('.depth-header'));
        
        // Store header data with order and natural positions
        const headerData = headers.map((header, index) => {
          return {
            el: header,
            order: index,
            naturalTop: 0 // Will be calculated after load
          };
        });

        function updateStickyHeaders() {
          if (!scrollContainer) return;
          
          const scrollTop = scrollContainer.scrollTop;
          const containerHeight = scrollContainer.clientHeight;
          const scrollBottom = scrollTop + containerHeight;
          
          // Calculate cumulative offsets for each header based on content above it
          let cumulativeOffset = 0;
          headerData.forEach((data, index) => {
            // Get the header's position relative to the scroll container's content
            const headerOffsetTop = data.el.offsetTop;
            
            // Calculate top sticky offset (how many headers above are stuck)
            const topOffset = index * HEADER_HEIGHT;
            
            // Calculate bottom sticky offset (how many headers below could be stuck)
            const bottomIndex = headerData.length - 1 - index;
            const bottomOffset = bottomIndex * HEADER_HEIGHT;
            
            // Apply sticky positioning with calculated offsets
            data.el.style.position = 'sticky';
            data.el.style.top = topOffset + 'px';
            data.el.style.bottom = bottomOffset + 'px';
            data.el.style.zIndex = 100 - index;
          });
        }

        // Function to recalculate natural positions
        function recalculateNaturalPositions() {
          if (!scrollContainer) return;
          headerData.forEach((data) => {
            data.naturalTop = getOffsetInContainer(data.el);
          });
        }

        // Run on scroll and resize
        scrollContainer.addEventListener('scroll', updateStickyHeaders, { passive: true });
        window.addEventListener('resize', () => {
          recalculateNaturalPositions();
          updateStickyHeaders();
        });
        
        // Initial calls - ensure layout is computed after images load
        updateStickyHeaders();
        requestAnimationFrame(updateStickyHeaders);
        
        // Helper to get element's top position relative to scroll container
        function getOffsetInContainer(element) {
          if (!scrollContainer) return 0;
          let offset = 0;
          let el = element;
          while (el && el !== scrollContainer && el !== document.body) {
            offset += el.offsetTop;
            el = el.offsetParent;
          }
          return offset;
        }

        // Also run after all resources (images) are loaded
        window.addEventListener('load', () => {
          // Calculate and store natural positions for all headers
          headerData.forEach((data) => {
            data.naturalTop = getOffsetInContainer(data.el);
          });
          
          // Scroll to center the focus section
          const focalHeader = document.querySelector('.depth-header--focal');
          const focalData = headerData.find(d => d.el === focalHeader);
          if (focalData && scrollContainer) {
            const containerHeight = scrollContainer.clientHeight;
            const targetScroll = focalData.naturalTop - (containerHeight / 2) + (HEADER_HEIGHT / 2);
            scrollContainer.scrollTo({ top: Math.max(0, targetScroll), behavior: 'instant' });
          }
          
          // Update sticky headers after scroll
          setTimeout(updateStickyHeaders, 10);
          setTimeout(updateStickyHeaders, 50);
          setTimeout(updateStickyHeaders, 100);
        });

        // Depth header click to scroll - scroll to show section at top
        headers.forEach((header, index) => {
          header.addEventListener('click', (e) => {
            if (!scrollContainer) return;
            
            // Use pre-calculated natural position
            const data = headerData[index];
            if (!data) return;
            
            // Scroll so this header is at the top, accounting for headers above
            const stickyOffset = index * HEADER_HEIGHT;
            const targetPosition = data.naturalTop - stickyOffset;
            scrollContainer.scrollTo({ top: Math.max(0, targetPosition), behavior: 'smooth' });
          });
        });

        // Group collapse toggle
        document.querySelectorAll('.group-header').forEach(groupHeader => {
          groupHeader.addEventListener('click', (e) => {
            e.stopPropagation();
            const group = groupHeader.closest('.object-group');
            group.classList.toggle('collapsed');
            // Update sticky headers after collapse animation
            setTimeout(updateStickyHeaders, 50);
            setTimeout(updateStickyHeaders, 150);
            setTimeout(updateStickyHeaders, 300);
          });
        });

        // Hover highlighting for connected objects
        const allItems = document.querySelectorAll('.group-list li');
        
        // Build a map of object names to their elements
        const objectMap = new Map();
        allItems.forEach(item => {
          const nameEl = item.querySelector('.object-name');
          if (nameEl) {
            const name = nameEl.textContent.trim().toLowerCase();
            if (!objectMap.has(name)) {
              objectMap.set(name, []);
            }
            objectMap.get(name).push(item);
          }
        });

        // Get depth level of an item
        function getDepthRow(item) {
          const depthContent = item.closest('.depth-content');
          return depthContent ? parseInt(depthContent.dataset.row) : null;
        }

        // Find connected objects with direction
        function getConnectedObjects(item) {
          const upstream = []; // -1 level (connection tags highlight)
          const downstream = []; // +1 level (object name highlights)
          const currentRow = getDepthRow(item);
          const currentName = item.querySelector('.object-name')?.textContent.trim().toLowerCase();
          
          // Get objects referenced in this item's connection tags
          const connectionTags = item.querySelectorAll('.connection-tag');
          connectionTags.forEach(tag => {
            const refName = tag.textContent.trim().toLowerCase();
            const refItems = objectMap.get(refName) || [];
            refItems.forEach(refItem => {
              const refRow = getDepthRow(refItem);
              if (refRow === currentRow - 1) {
                upstream.push(refItem);
              } else if (refRow === currentRow + 1) {
                downstream.push(refItem);
              }
            });
          });
          
          // Find objects that reference this item
          allItems.forEach(otherItem => {
            const otherRow = getDepthRow(otherItem);
            const otherTags = otherItem.querySelectorAll('.connection-tag');
            otherTags.forEach(tag => {
              if (tag.textContent.trim().toLowerCase() === currentName) {
                if (otherRow === currentRow - 1) {
                  upstream.push(otherItem);
                } else if (otherRow === currentRow + 1) {
                  downstream.push(otherItem);
                }
              }
            });
          });
          
          return { upstream, downstream };
        }

        // Add hover listeners
        allItems.forEach(item => {
          item.addEventListener('mouseenter', () => {
            // Highlight current row's connection tags
            item.classList.add('highlight-current');
            
            // Get connected objects
            const { upstream, downstream } = getConnectedObjects(item);
            
            // Highlight upstream (-1) objects - their connection tags
            upstream.forEach(upItem => {
              upItem.classList.add('highlight-upstream');
            });
            
            // Highlight downstream (+1) objects - their object names
            downstream.forEach(downItem => {
              downItem.classList.add('highlight-downstream');
            });
          });
          
          item.addEventListener('mouseleave', () => {
            item.classList.remove('highlight-current');
            document.querySelectorAll('.highlight-upstream').forEach(el => {
              el.classList.remove('highlight-upstream');
            });
            document.querySelectorAll('.highlight-downstream').forEach(el => {
              el.classList.remove('highlight-downstream');
            });
          });
        });

        // Click on connection-tag to scroll to and select corresponding node
        document.querySelectorAll('.connection-tag').forEach(tag => {
          tag.style.cursor = 'pointer';
          tag.addEventListener('click', (e) => {
            e.stopPropagation();
            const refName = tag.textContent.trim().toLowerCase();
            const refItems = objectMap.get(refName) || [];
            
            if (refItems.length > 0) {
              const targetItem = refItems[0];
              
              // Expand parent group if collapsed
              const parentGroup = targetItem.closest('.object-group');
              if (parentGroup && parentGroup.classList.contains('collapsed')) {
                parentGroup.classList.toggle('collapsed');
                setTimeout(() => {
                  scrollToItem(targetItem);
                  selectItem(targetItem);
                }, 100);
              } else {
                scrollToItem(targetItem);
                selectItem(targetItem);
              }
            }
          });
        });

        function scrollToItem(targetItem) {
          if (!scrollContainer) return;
          const targetTop = getOffsetInContainer(targetItem);
          const containerHeight = scrollContainer.clientHeight;
          const targetScroll = targetTop - (containerHeight / 2) + 16;
          
          scrollContainer.scrollTo({ top: Math.max(0, targetScroll), behavior: 'smooth' });
          
          // Briefly highlight the target
          targetItem.style.transition = 'background 0.3s';
          targetItem.style.background = 'hsla(217, 13%, 94%, 1)';
          setTimeout(() => {
            targetItem.style.background = '';
            setTimeout(() => {
              targetItem.style.transition = '';
            }, 300);
          }, 1000);
        }

        // Object selection and side panel
        const sidePanel = document.getElementById('sidePanel');
        const panelClose = document.getElementById('panelClose');
        const panelIcon = document.getElementById('panelIcon');
        const panelTitle = document.getElementById('panelTitle');
        const panelSchema = document.getElementById('panelSchema');
        let selectedItem = null;

        // Function to select an item and update panel
        function selectItem(item) {
          // Deselect previous
          if (selectedItem) {
            selectedItem.classList.remove('selected');
          }
          
          // Select new
          selectedItem = item;
          item.classList.add('selected');
          
          // Get object info
          const objectName = item.querySelector('.object-name')?.textContent || 'Unknown';
          const objectIcon = item.querySelector('.object-icon')?.src || './img/table.svg';
          const groupName = item.closest('.object-group')?.querySelector('.group-name')?.textContent || '-';
          
          // Update panel
          panelTitle.textContent = objectName;
          panelIcon.src = objectIcon;
          panelSchema.textContent = groupName;
          
          // Show panel
          sidePanel.classList.remove('hidden');
        }

        // Click to select object
        allItems.forEach(item => {
          item.style.cursor = 'pointer';
          item.addEventListener('click', (e) => {
            // Don't select if clicking on connection tag
            if (e.target.classList.contains('connection-tag')) return;
            
            selectItem(item);
          });
        });

        // Close panel
        panelClose.addEventListener('click', () => {
          sidePanel.classList.add('hidden');
          if (selectedItem) {
            selectedItem.classList.remove('selected');
            selectedItem = null;
          }
          updateStickyHeaders();
        });

        // Segmented button toggle (Graph/List)
        const toggleBtns = document.querySelectorAll('.view-toggle .toggle-btn');
        console.log('Toggle buttons found:', toggleBtns.length);
        toggleBtns.forEach(btn => {
          btn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            console.log('Toggle clicked:', btn.textContent);
            // Remove active from all
            toggleBtns.forEach(b => b.classList.remove('active'));
            // Add active to clicked
            btn.classList.add('active');
          });
        });
      });
    </script>

    <div class="main-layout">

      <div class="view-panel">

        <div class="tool-bar">
          <div class="toolbar-left">
            <div class="view-toggle">
              <button class="toggle-btn">Graph</button>
              <button class="toggle-btn active">List</button>
            </div>
            <button class="toolbar-btn">
              <img src="./img/filter.svg" alt="" width="16" height="16">
              Filter
            </button>
          </div>
          <div class="toolbar-right">
            <button class="toolbar-btn icon-only">
              <img src="./img/maximize.svg" alt="" width="16" height="16">
            </button>
            <button class="toolbar-btn dropdown">
              <img src="./img/circle.svg" alt="" width="8" height="8">
              ORGADMIN
              <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3 5l3 3 3-3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </div>
        </div>

        <div class="lineage-scroll">
          <section class="lineage-table" aria-label="Lineage list">
            <!-- Upstream Level 3 (furthest) - Row 1 -->
            <div class="depth-header" data-row="1" data-order="0">
              <span class="depth-badge depth-badge--upstream">Upstream ‚àí3</span>
              
            </div>
            <div class="depth-content" data-row="1">
              <div class="object-group">
                <div class="group-header">
                  <img class="chevron" src="./img/chevron-down-small.svg" alt="">
                  <img class="group-icon" src="./img/api.svg" alt="API">
                  <span class="group-name">External APIs</span>
                  <span class="group-count">6</span>
                </div>
                <ul class="group-list">
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/api.svg" alt="API">
                      <span class="object-name">Shopify Orders API</span>
                    </div>
                    <div class="connections connections--downstream">
                      <span class="connection-tag">orders</span>
                    </div>
                  </li>
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/api.svg" alt="API">
                      <span class="object-name">Stripe Payments API</span>
                    </div>
                    <div class="connections connections--downstream">
                      <span class="connection-tag">payments</span>
                    </div>
                  </li>
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/api.svg" alt="API">
                      <span class="object-name">Salesforce CRM</span>
                    </div>
                    <div class="connections connections--downstream">
                      <span class="connection-tag">customers</span>
                    </div>
                  </li>
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/api.svg" alt="API">
                      <span class="object-name">Google Analytics 4</span>
                    </div>
                    <div class="connections connections--downstream">
                      <span class="connection-tag">ga_sessions</span>
                      <span class="connection-tag">ga_events</span>
                    </div>
                  </li>
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/api.svg" alt="API">
                      <span class="object-name">Facebook Ads API</span>
                    </div>
                    <div class="connections connections--downstream">
                      <span class="connection-tag">ad_spend</span>
                    </div>
                  </li>
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/api.svg" alt="API">
                      <span class="object-name">Mixpanel Events</span>
                    </div>
                    <div class="connections connections--downstream">
                      <span class="connection-tag">product_events</span>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
      
            <!-- Upstream Level 2 - Row 2 -->
            <div class="depth-header" data-row="2" data-order="1">
              <span class="depth-badge depth-badge--upstream">Upstream ‚àí2</span>
              
            </div>
            <div class="depth-content" data-row="2">
              <!-- Snowflake: RAW_ECOMMERCE -->
              <div class="object-group">
                <div class="group-header">
                  <img class="chevron" src="./img/chevron-down-small.svg" alt="">
                  <img class="group-icon" src="./img/logo-snowflake.svg" alt="Snowflake">
                  <span class="group-name">ACME_PROD / RAW_DB / RAW_ECOMMERCE</span>
                  <span class="group-count">3</span>
                </div>
                <ul class="group-list">
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/table.svg" alt="Table">
                      <span class="object-name">orders</span>
                    </div>
                    <div class="connections connections--downstream">
                      <span class="connection-tag">stg_orders</span>
                    </div>
                  </li>
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/table.svg" alt="Table">
                      <span class="object-name">payments</span>
                    </div>
                    <div class="connections connections--downstream">
                      <span class="connection-tag">stg_payments</span>
                    </div>
                  </li>
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/table.svg" alt="Table">
                      <span class="object-name">customers</span>
                    </div>
                    <div class="connections connections--downstream">
                      <span class="connection-tag">stg_customers</span>
                      <span class="connection-tag">stg_orders</span>
                    </div>
                  </li>
                </ul>
              </div>
      
              <!-- Snowflake: RAW_MARKETING -->
              <div class="object-group">
                <div class="group-header">
                  <img class="chevron" src="./img/chevron-down-small.svg" alt="">
                  <img class="group-icon" src="./img/logo-snowflake.svg" alt="Snowflake">
                  <span class="group-name">ACME_PROD / RAW_DB / RAW_MARKETING</span>
                  <span class="group-count">4</span>
                </div>
                <ul class="group-list">
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/table.svg" alt="Table">
                      <span class="object-name">ga_sessions</span>
                    </div>
                    <div class="connections connections--downstream">
                      <span class="connection-tag">stg_sessions</span>
                    </div>
                  </li>
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/table.svg" alt="Table">
                      <span class="object-name">ga_events</span>
                    </div>
                    <div class="connections connections--downstream">
                      <span class="connection-tag">stg_web_events</span>
                    </div>
                  </li>
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/table.svg" alt="Table">
                      <span class="object-name">ad_spend</span>
                    </div>
                    <div class="connections connections--downstream">
                      <span class="connection-tag">stg_ad_spend</span>
                    </div>
                  </li>
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/table.svg" alt="Table">
                      <span class="object-name">product_events</span>
                    </div>
                    <div class="connections connections--downstream">
                      <span class="connection-tag">stg_web_events</span>
                      <span class="connection-tag">stg_sessions</span>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
      
            <!-- Upstream Level 1 - Row 3 -->
            <div class="depth-header" data-row="3" data-order="2">
              <span class="depth-badge depth-badge--upstream">Upstream ‚àí1</span>
              
            </div>
            <div class="depth-content" data-row="3">
              <div class="object-group">
                <div class="group-header">
                  <img class="chevron" src="./img/chevron-down-small.svg" alt="">
                  <img class="group-icon" src="./img/logo-snowflake.svg" alt="Snowflake">
                  <span class="group-name">ACME_PROD / TRANSFORM_DB / STAGING</span>
                  <span class="group-count">6</span>
                </div>
                <ul class="group-list">
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/view.svg" alt="View">
                      <span class="object-name">stg_orders</span>
                    </div>
                    <div class="connections connections--upstream">
                      <span class="connection-tag tag--blue">orders</span>
                      <span class="connection-tag tag--blue">customers</span>
                    </div>
                  </li>
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/view.svg" alt="View">
                      <span class="object-name">stg_payments</span>
                    </div>
                    <div class="connections connections--upstream">
                      <span class="connection-tag tag--blue">payments</span>
                    </div>
                  </li>
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/view.svg" alt="View">
                      <span class="object-name">stg_customers</span>
                    </div>
                    <div class="connections connections--upstream">
                      <span class="connection-tag tag--blue">customers</span>
                    </div>
                  </li>
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/view.svg" alt="View">
                      <span class="object-name">stg_sessions</span>
                    </div>
                    <div class="connections connections--upstream">
                      <span class="connection-tag tag--green">ga_sessions</span>
                      <span class="connection-tag tag--green">product_events</span>
                    </div>
                  </li>
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/view.svg" alt="View">
                      <span class="object-name">stg_web_events</span>
                    </div>
                    <div class="connections connections--upstream">
                      <span class="connection-tag tag--green">ga_events</span>
                      <span class="connection-tag tag--green">product_events</span>
                    </div>
                  </li>
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/view.svg" alt="View">
                      <span class="object-name">stg_ad_spend</span>
                    </div>
                    <div class="connections connections--upstream">
                      <span class="connection-tag tag--green">ad_spend</span>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
      
            <!-- Focal object - Row 4 -->
            <div class="depth-header depth-header--focal" data-row="4" data-order="3">
              <span class="depth-badge depth-badge--focal">Currently viewing</span>
              
            </div>
            <div class="depth-content depth-content--focal" data-row="4">
              <div class="object-group">
                <div class="group-header group-header--focal">
                  <img class="chevron" src="./img/chevron-down-small.svg" alt="">
                  <img class="group-icon" src="./img/logo-snowflake.svg" alt="Snowflake">
                  <span class="group-name">ACME_ANALYTICS / ANALYTICS_DB / ANALYTICS</span>
                  <span class="group-count">1</span>
                </div>
                <ul class="group-list">
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/dataset.svg" alt="Dataset">
                      <span class="object-name">fct_customer_orders</span>
                    </div>
                    <div class="connections connections--upstream">
                      <span class="connection-tag tag--gray">stg_orders</span>
                      <span class="connection-tag tag--gray">stg_payments</span>
                      <span class="connection-tag tag--gray">stg_customers</span>
                      <span class="connection-tag tag--gray">stg_sessions</span>
                      <span class="connection-tag tag--gray">stg_web_events</span>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
      
            <!-- Downstream Level 1 - Row 5 -->
            <div class="depth-header" data-row="5" data-order="4">
              <span class="depth-badge depth-badge--downstream">Downstream +1</span>
              
            </div>
            <div class="depth-content" data-row="5">
              <div class="object-group">
                <div class="group-header">
                  <img class="chevron" src="./img/chevron-down-small.svg" alt="">
                  <img class="group-icon" src="./img/logo-snowflake.svg" alt="Snowflake">
                  <span class="group-name">ACME_ANALYTICS / ANALYTICS_DB / MARTS</span>
                  <span class="group-count">4</span>
                </div>
                <ul class="group-list">
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/table.svg" alt="Table">
                      <span class="object-name">dim_customers</span>
                    </div>
                    <div class="connections connections--downstream">
                      <span class="connection-tag">Customer 360</span>
                      <span class="connection-tag">churn_model</span>
                    </div>
                  </li>
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/table.svg" alt="Table">
                      <span class="object-name">fct_daily_revenue</span>
                    </div>
                    <div class="connections connections--downstream">
                      <span class="connection-tag">Exec Dashboard</span>
                      <span class="connection-tag">Finance Report</span>
                    </div>
                  </li>
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/table.svg" alt="Table">
                      <span class="object-name">fct_attribution</span>
                    </div>
                    <div class="connections connections--downstream">
                      <span class="connection-tag">Marketing ROI</span>
                      <span class="connection-tag">attribution_model</span>
                    </div>
                  </li>
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/table.svg" alt="Table">
                      <span class="object-name">user_journey_agg</span>
                    </div>
                    <div class="connections connections--downstream">
                      <span class="connection-tag">Product Analytics</span>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
      
            <!-- Downstream Level 2 - Row 6 -->
            <div class="depth-header" data-row="6" data-order="5">
              <span class="depth-badge depth-badge--downstream">Downstream +2</span>
              
            </div>
            <div class="depth-content" data-row="6">
              <!-- Tableau -->
              <div class="object-group">
                <div class="group-header">
                  <img class="chevron" src="./img/chevron-down-small.svg" alt="">
                  <img class="group-icon" src="./img/logo-tableau.svg" alt="Tableau">
                  <span class="group-name">Tableau</span>
                  <span class="group-count">1</span>
                </div>
                <ul class="group-list">
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/dashboard.svg" alt="Dashboard">
                      <span class="object-name">Exec Revenue Dashboard</span>
                    </div>
                    <div class="connections connections--upstream">
                      <span class="connection-tag tag--purple">fct_daily_revenue</span>
                    </div>
                  </li>
                </ul>
              </div>
      
              <!-- Looker -->
              <div class="object-group">
                <div class="group-header">
                  <img class="chevron" src="./img/chevron-down-small.svg" alt="">
                  <img class="group-icon" src="./img/logo-looker.svg" alt="Looker">
                  <span class="group-name">Looker</span>
                  <span class="group-count">2</span>
                </div>
                <ul class="group-list">
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/dashboard.svg" alt="Dashboard">
                      <span class="object-name">Customer 360 Dashboard</span>
                    </div>
                    <div class="connections connections--upstream">
                      <span class="connection-tag tag--purple">dim_customers</span>
                    </div>
                  </li>
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/dashboard.svg" alt="Dashboard">
                      <span class="object-name">Marketing ROI Dashboard</span>
                    </div>
                    <div class="connections connections--upstream">
                      <span class="connection-tag tag--purple">fct_attribution</span>
                    </div>
                  </li>
                </ul>
              </div>
      
              <!-- ML Models -->
              <div class="object-group">
                <div class="group-header">
                  <img class="chevron" src="./img/chevron-down-small.svg" alt="">
                  <img class="group-icon" src="./img/model.svg" alt="Model">
                  <span class="group-name">ML Models</span>
                  <span class="group-count">2</span>
                </div>
                <ul class="group-list">
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/model.svg" alt="Model">
                      <span class="object-name">churn_prediction_model</span>
                    </div>
                    <div class="connections connections--upstream">
                      <span class="connection-tag tag--purple">dim_customers</span>
                    </div>
                  </li>
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/model.svg" alt="Model">
                      <span class="object-name">attribution_model</span>
                    </div>
                    <div class="connections connections--upstream">
                      <span class="connection-tag tag--purple">fct_attribution</span>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
      
            <!-- Downstream Level 3 - Row 7 -->
            <div class="depth-header" data-row="7" data-order="6">
              <span class="depth-badge depth-badge--downstream">Downstream +3</span>
              
            </div>
            <div class="depth-content" data-row="7">
              <div class="object-group">
                <div class="group-header">
                  <img class="chevron" src="./img/chevron-down-small.svg" alt="">
                  <img class="group-icon" src="./img/api.svg" alt="Export">
                  <span class="group-name">Exports</span>
                  <span class="group-count">2</span>
                </div>
                <ul class="group-list">
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/api.svg" alt="Email">
                      <span class="object-name">Finance Weekly Report</span>
                    </div>
                    <div class="connections connections--upstream">
                      <span class="connection-tag">Exec Dashboard</span>
                    </div>
                  </li>
                  <li>
                    <div class="object-info">
                      <img class="object-icon" src="./img/api.svg" alt="Export">
                      <span class="object-name">Investor Data Room</span>
                    </div>
                    <div class="connections connections--upstream">
                      <span class="connection-tag">Exec Dashboard</span>
                      <span class="connection-tag">Customer 360</span>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
          </section>    
        </div>
      
      </div>

    <!-- Side Panel -->
    <aside class="side-panel hidden" id="sidePanel">
      <div class="panel-header">
        <img class="panel-header-icon" id="panelIcon" src="./img/table.svg" alt="">
        <span class="panel-header-title" id="panelTitle">Object Name</span>
        <span class="panel-close" id="panelClose">‚úï</span>
      </div>
      <div class="panel-content">
        <div class="panel-section">
          <div class="panel-label">Database / schema</div>
          <div class="panel-value" id="panelSchema">-</div>
        </div>
        <div class="panel-section">
          <div class="panel-label">Comment</div>
          <div class="panel-value" id="panelComment">-</div>
        </div>
        <div class="panel-section">
          <div class="panel-label">Owner</div>
          <div class="panel-value" id="panelOwner">ACCOUNTADMIN</div>
        </div>
        <div class="panel-section">
          <div class="panel-label">Created</div>
          <div class="panel-value" id="panelCreated">-</div>
        </div>
        <div class="panel-section">
          <div class="panel-label">Data quality</div>
          <div class="panel-value" id="panelQuality">-</div>
        </div>
        <div class="panel-section">
          <div class="panel-label">Rows</div>
          <div class="panel-value" id="panelRows">-</div>
        </div>
        <div class="panel-section">
          <div class="panel-label">Tags</div>
          <div class="panel-tags" id="panelTags">
            <span class="panel-tag">‚ü®‚ü© SEMANTIC_CATEGORY | EMAIL</span>
            <span class="panel-tag">üè¢ COST_CENTER | PRODUCT</span>
            <span class="panel-tag">üîí PII | DATA</span>
          </div>
        </div>
        <div class="panel-section">
          <div class="panel-columns-header">Columns</div>
          <div class="panel-search">
            <input type="text" placeholder="Search columns">
          </div>
          <div class="panel-column-list" id="panelColumns">
            <div class="panel-column-item"><span class="panel-column-icon">‚è±</span> PTIME</div>
            <div class="panel-column-item"><span class="panel-column-icon">‚ñ≥</span> TOPIC</div>
            <div class="panel-column-item"><span class="panel-column-icon">‚ñ≥</span> PRODUCT_KEY</div>
            <div class="panel-column-item"><span class="panel-column-icon">‚ñ≥</span> CITY</div>
          </div>
        </div>
      </div>
    </aside>
    </div>
  </body>
</html>
